# Salary Management System - Database Schema

## Tables Structure

### 1. users
- `id` (uuid, primary key) - Generated by Supabase Auth
- `email` (text, unique)
- `created_at` (timestamp)
- `role` (text) - 'admin', 'hr', etc.
- `full_name` (text)
- `last_sign_in` (timestamp)

### 2. departments
- `id` (uuid, primary key)
- `name` (text)
- `description` (text)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 3. roles
- `id` (uuid, primary key)
- `title` (text)
- `department_id` (uuid, foreign key to departments.id)
- `description` (text)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 4. employees
- `id` (uuid, primary key)
- `employee_id` (text, unique) - Custom ID format for the organization
- `first_name` (text)
- `last_name` (text)
- `email` (text, unique)
- `phone` (text)
- `address` (text)
- `date_of_birth` (date)
- `gender` (text)
- `joining_date` (date)
- `department_id` (uuid, foreign key to departments.id)
- `role_id` (uuid, foreign key to roles.id)
- `reporting_to` (uuid, foreign key to employees.id)
- `status` (text) - 'active', 'inactive', 'on_leave', etc.
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 5. employee_bank_details
- `id` (uuid, primary key)
- `employee_id` (uuid, foreign key to employees.id)
- `bank_name` (text)
- `account_number` (text)
- `ifsc_code` (text)
- `branch` (text)
- `is_primary` (boolean)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 6. employee_documents
- `id` (uuid, primary key)
- `employee_id` (uuid, foreign key to employees.id)
- `document_type` (text) - 'aadhar', 'pan', 'offer_letter', etc.
- `document_number` (text)
- `file_path` (text) - URL to the document in storage
- `expiry_date` (date)
- `is_verified` (boolean)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 7. salary_components
- `id` (uuid, primary key)
- `name` (text)
- `type` (text) - 'earning', 'deduction', 'tax', etc.
- `is_taxable` (boolean)
- `is_percentage` (boolean)
- `percentage_of` (text) - 'basic', 'gross', etc. (if is_percentage is true)
- `description` (text)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 8. salary_structures
- `id` (uuid, primary key)
- `name` (text)
- `description` (text)
- `is_active` (boolean)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 9. salary_structure_components
- `id` (uuid, primary key)
- `salary_structure_id` (uuid, foreign key to salary_structures.id)
- `component_id` (uuid, foreign key to salary_components.id)
- `amount` (decimal)
- `percentage` (decimal) - Used if the component is percentage-based
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 10. employee_salary
- `id` (uuid, primary key)
- `employee_id` (uuid, foreign key to employees.id)
- `salary_structure_id` (uuid, foreign key to salary_structures.id)
- `effective_from` (date)
- `effective_to` (date)
- `basic_salary` (decimal)
- `gross_salary` (decimal)
- `net_salary` (decimal)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 11. attendance
- `id` (uuid, primary key)
- `employee_id` (uuid, foreign key to employees.id)
- `date` (date)
- `check_in` (timestamp)
- `check_out` (timestamp)
- `status` (text) - 'present', 'absent', 'half_day', 'leave', etc.
- `source` (text) - 'manual', 'biometric', etc.
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 12. leave_types
- `id` (uuid, primary key)
- `name` (text)
- `description` (text)
- `annual_quota` (integer)
- `is_paid` (boolean)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 13. employee_leaves
- `id` (uuid, primary key)
- `employee_id` (uuid, foreign key to employees.id)
- `leave_type_id` (uuid, foreign key to leave_types.id)
- `start_date` (date)
- `end_date` (date)
- `reason` (text)
- `status` (text) - 'pending', 'approved', 'rejected', etc.
- `approved_by` (uuid, foreign key to users.id)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 14. payroll
- `id` (uuid, primary key)
- `employee_id` (uuid, foreign key to employees.id)
- `month` (integer)
- `year` (integer)
- `basic_salary` (decimal)
- `gross_salary` (decimal)
- `total_deductions` (decimal)
- `net_salary` (decimal)
- `payment_status` (text) - 'pending', 'processed', 'paid', etc.
- `payment_date` (date)
- `payment_method` (text)
- `transaction_reference` (text)
- `created_by` (uuid, foreign key to users.id)
- `approved_by` (uuid, foreign key to users.id)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 15. payroll_components
- `id` (uuid, primary key)
- `payroll_id` (uuid, foreign key to payroll.id)
- `component_id` (uuid, foreign key to salary_components.id)
- `amount` (decimal)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 16. tax_information
- `id` (uuid, primary key)
- `employee_id` (uuid, foreign key to employees.id)
- `financial_year` (text)
- `pan_number` (text)
- `tax_regime` (text) - 'old', 'new'
- `total_income` (decimal)
- `total_deductions` (decimal)
- `taxable_income` (decimal)
- `tax_payable` (decimal)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 17. tax_deductions
- `id` (uuid, primary key)
- `tax_information_id` (uuid, foreign key to tax_information.id)
- `deduction_type` (text) - '80C', '80D', etc.
- `amount` (decimal)
- `proof_document` (text) - URL to the document in storage
- `is_verified` (boolean)
- `created_at` (timestamp)
- `updated_at` (timestamp)

### 18. payslips
- `id` (uuid, primary key)
- `payroll_id` (uuid, foreign key to payroll.id)
- `file_path` (text) - URL to the generated payslip in storage
- `is_emailed` (boolean)
- `emailed_at` (timestamp)
- `created_at` (timestamp)
- `updated_at` (timestamp)

## Relationships

1. A department can have multiple roles
2. A role belongs to a department
3. An employee belongs to a department and has a role
4. An employee can have multiple bank details
5. An employee can have multiple documents
6. A salary structure can have multiple components
7. An employee can have one active salary structure
8. An employee can have multiple attendance records
9. An employee can have multiple leave records
10. An employee can have multiple payroll records
11. A payroll record can have multiple components
12. An employee can have one tax information record per financial year
13. A tax information record can have multiple deduction records
14. A payroll record can have one payslip